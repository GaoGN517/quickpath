library(quickpath)
head(gene_exp.diff)
deg = grab_deg_from_cuffdiff(gene_exp.diff, class = "mmu")
head(deg)
sig.genes = deg$external_gene_name
path_res = pathway_analysis(sig.genes, class = "mmu")
pathway <- c("Purine metabolism", "PI3K-Akt signaling pathway", "AMPK signaling pathway", "Choline metabolism in cancer")
deg.list = extract_degs_by_pathway(pathway, deg, class = "mmu")
deg_chow = grab_deg_from_cuffdiff(gene_exp.diff_chow, class = "mmu")
sig.genes = deg_chow$external_gene_name
path_res_chow = pathway_analysis(sig.genes, class = "mmu")
deg_chow = grab_deg_from_cuffdiff(gene_exp.diff_chow, class = "mmu")
sig.genes = deg_chow$external_gene_name
path_res_chow = pathway_analysis(sig.genes, class = "mmu")
getAnywhere(pvalhyper)
deg_chow = grab_deg_from_cuffdiff(gene_exp.diff_chow, class = "mmu")
sig.genes = deg_chow$external_gene_name
path_res_chow = pathway_analysis(sig.genes, class = "mmu")
deg_e95 = grab_deg_from_cuffdiff(gene_exp.diff_e95, class = "mmu")
sig.genes = deg_e95$external_gene_name
path_res_e95 = pathway_analysis(sig.genes, class = "mmu")
deg_e105 = grab_deg_from_cuffdiff(gene_exp.diff_e105, class = "mmu")
sig.genes = deg_e105$external_gene_name
path_res_e105 = pathway_analysis(sig.genes, class = "mmu")
#'
#'@param sig.genes A vector of significantly changed genes
#'@param class Specify which type of gene
#'@param mc.cores Specify how many cores to use
#'@return A list of all significantly changed pathways, and all pathways with p value
#'@examples
#'deg = grab_deg_from_cuffdiff(gene_exp.diff)
#'sig.genes = deg$external_gene_name
#'path_res = pathway_analysis(sig.genes, class = "mmu")
#'@export
pathway_analysis <- function(sig.genes, class=c("mmu","hsa","gga"), mccores = 8){
############## prepare needed data #################
all = eval(parse(text = paste0("genes_pathways_",class)))
paths = eval(parse(text = paste0(class,"_pathway")))
path.gene = eval(parse(text = paste0(class,"_path_gene_list")))
############# clean background gene list ############
all.genes <- all$gene.symbol
all.genes <- all.genes[!is.na(all.genes)]
all.genes <- unique(all$gene.symbol)
############ clean DEGs list #################
sig.genes <- sig.genes[!is.na(sig.genes)]
sig.genes <- unique(sig.genes)
sig.genes <- unique(intersect(sig.genes,all.genes))
###########################################
print(paste0("sig genes in pathway: ",length(sig.genes),"/",length(all.genes)))
################### do hypergeometric test ###########
out <- parallel::mclapply(path.gene,function(x){
if(!is.na(x)){
symbol <- na.omit(x[,1])
symbol = symbol[!is.na(symbol)]
pval.percent = pvalhyper(all.genes,sig.genes,symbol)
return(pval.percent)
}
else{
return(c(NA,NA))
}
},mc.cores = mccores)
print("Inference part is Done.")
############## format results ##################
tmpname <- names(out)
out <- t(as.data.frame(out))
colnames(out) <- c("pval","percentage")
out <- as.data.frame(out)
rownames(out) <- tmpname
qval <- p.adjust(out$pval,"fdr")
df <- data.frame(name = rownames(out),pval=as.numeric(out$pval),qval=as.numeric(qval),percentage=as.numeric(out$percentage))
out <- merge(paths,df,by="name")
out <- na.omit(out)
return(list(out[out$pval<=0.05,],
out))
}
deg_chow = grab_deg_from_cuffdiff(gene_exp.diff_chow, class = "mmu")
sig.genes = deg_chow$external_gene_name
path_res_chow = pathway_analysis(sig.genes, class = "mmu")
############## get pvalue from hypergeometric distribution ############
pvalhyper <- function(all.genes, sig.genes, gs){
N = length(all.genes)
R = length(sig.genes)
n = length(gs)
r = length(intersect(gs, sig.genes))
if(r==0){
return(c(1,r/n))
}
else{
pval <- 1 - sum(dhyper(0:r-1,R,N-R,n))
return(c(pval,r/n))
}
}
deg_chow = grab_deg_from_cuffdiff(gene_exp.diff_chow, class = "mmu")
sig.genes = deg_chow$external_gene_name
path_res_chow = pathway_analysis(sig.genes, class = "mmu")
deg_e95 = grab_deg_from_cuffdiff(gene_exp.diff_e95, class = "mmu")
sig.genes = deg_e95$external_gene_name
path_res_e95 = pathway_analysis(sig.genes, class = "mmu")
deg_e105 = grab_deg_from_cuffdiff(gene_exp.diff_e105, class = "mmu")
sig.genes = deg_e105$external_gene_name
path_res_e105 = pathway_analysis(sig.genes, class = "mmu")
deg_egg = grab_deg_from_cuffdiff(gene_exp.diff_egg, class = "gga")
sig.genes = deg_egg$external_gene_name
path_res_egg = pathway_analysis(sig.genes, class = "gga")
library(quickpath)
head(gene_exp.diff)
deg = grab_deg_from_cuffdiff(gene_exp.diff, class = "mmu")
head(deg)
sig.genes = deg$external_gene_name
path_res = pathway_analysis(sig.genes, class = "mmu")
pathway <- c("Purine metabolism", "PI3K-Akt signaling pathway", "AMPK signaling pathway", "Choline metabolism in cancer")
deg.list = extract_degs_by_pathway(pathway, deg, class = "mmu")
deg_chow = grab_deg_from_cuffdiff(gene_exp.diff_chow, class = "mmu")
sig.genes = deg_chow$external_gene_name
path_res_chow = pathway_analysis(sig.genes, class = "mmu")
deg_e95 = grab_deg_from_cuffdiff(gene_exp.diff_e95, class = "mmu")
sig.genes = deg_e95$external_gene_name
path_res_e95 = pathway_analysis(sig.genes, class = "mmu")
deg_e105 = grab_deg_from_cuffdiff(gene_exp.diff_e105, class = "mmu")
sig.genes = deg_e105$external_gene_name
path_res_e105 = pathway_analysis(sig.genes, class = "mmu")
deg_chow = grab_deg_from_cuffdiff(gene_exp.diff_chow, class = "mmu")
sig.genes = deg_chow$external_gene_name
path_res_chow = pathway_analysis(sig.genes, class = "mmu")
library(quickpath)
library(quickpath)
head(gene_exp.diff)
deg = grab_deg_from_cuffdiff(gene_exp.diff, class = "mmu")
head(deg)
sig.genes = deg$external_gene_name
path_res = pathway_analysis(sig.genes, class = "mmu")
pathway <- c("Purine metabolism", "PI3K-Akt signaling pathway", "AMPK signaling pathway", "Choline metabolism in cancer")
deg.list = extract_degs_by_pathway(pathway, deg, class = "mmu")
deg_chow = grab_deg_from_cuffdiff(gene_exp.diff_chow, class = "mmu")
sig.genes = deg_chow$external_gene_name
path_res_chow = pathway_analysis(sig.genes, class = "mmu")
deg_chow = grab_deg_from_cuffdiff(gene_exp.diff_chow, class = "mmu")
sig.genes = deg_chow$external_gene_name
path_res_chow = pathway_analysis(sig.genes, class = "mmu")
deg_e95 = grab_deg_from_cuffdiff(gene_exp.diff_e95, class = "mmu")
sig.genes = deg_e95$external_gene_name
path_res_e95 = pathway_analysis(sig.genes, class = "mmu")
deg_e105 = grab_deg_from_cuffdiff(gene_exp.diff_e105, class = "mmu")
sig.genes = deg_e105$external_gene_name
path_res_e105 = pathway_analysis(sig.genes, class = "mmu")
deg_e105 = grab_deg_from_cuffdiff(gene_exp.diff_e105, class = "mmu")
sig.genes = deg_e105$external_gene_name
path_res_e105 = pathway_analysis(sig.genes, class = "mmu")
deg_egg = grab_deg_from_cuffdiff(gene_exp.diff_egg, class = "gga")
deg_egg = grab_deg_from_cuffdiff(gene_exp.diff_egg, class = "gga")
sig.genes = deg_egg$external_gene_name
path_res_egg = pathway_analysis(sig.genes, class = "gga")
deg_chow = grab_deg_from_cuffdiff(gene_exp.diff_chow, class = "mmu")
sig.genes = deg_chow$external_gene_name
path_res_chow = pathway_analysis(sig.genes, class = "mmu")
deg_e95 = grab_deg_from_cuffdiff(gene_exp.diff_e95, class = "mmu")
sig.genes = deg_e95$external_gene_name
path_res_e95 = pathway_analysis(sig.genes, class = "mmu")
deg_e105 = grab_deg_from_cuffdiff(gene_exp.diff_e105, class = "mmu")
sig.genes = deg_e105$external_gene_name
path_res_e105 = pathway_analysis(sig.genes, class = "mmu")
deg_chow = grab_deg_from_cuffdiff(gene_exp.diff_chow, class = "mmu")
sig.genes = deg_chow$external_gene_name
path_res_chow = pathway_analysis(sig.genes, class = "mmu")
path_res_chow = pathway_analysis(sig.genes, class = "mmu")
deg_e95 = grab_deg_from_cuffdiff(gene_exp.diff_e95, class = "mmu")
deg_e95 = grab_deg_from_cuffdiff(gene_exp.diff_e95, class = "mmu")
sig.genes = deg_e95$external_gene_name
sig.genes = deg_e95$external_gene_name
path_res_e95 = pathway_analysis(sig.genes, class = "mmu")
deg_e105 = grab_deg_from_cuffdiff(gene_exp.diff_e105, class = "mmu")
deg_e105 = grab_deg_from_cuffdiff(gene_exp.diff_e105, class = "mmu")
sig.genes = deg_e105$external_gene_name
path_res_e105 = pathway_analysis(sig.genes, class = "mmu")
deg_egg = grab_deg_from_cuffdiff(gene_exp.diff_egg, class = "gga")
sig.genes = deg_egg$external_gene_name
path_res_egg = pathway_analysis(sig.genes, class = "gga")
library(quickpath)
library(quickpath)
head(gene_exp.diff)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("biomaRt")
library(quickpath)
library(quickpath)
# tss <- readRDS("../tss_pernei.rds")
# tes <- readRDS("../tes_pernei.rds")
# methyl <- rbind(tss,tes)
# all.genes <- unique(methyl$gene)
# saveRDS(all.genes, "all_genes.rds")
all.genes <- readRDS("all_genes.rds")
meth.tss <- read.csv("../../pernei/new2TSS5000_HFvsNF_1646over66988_WGBS_perneighbor.csv",header=T,sep=",")
meth.tes <- read.csv("../../pernei/new2TES5000_HFvsNF_10345over455434_WGBS_perneighbor.csv",header=T,sep=",")
meth <- rbind(meth.tss,meth.tes)
sig.genes <- unique(meth$gene)
out.hfnf = pathway_analysis_meth(sig.genes, all.genes, class = "mmu")
meth.tss <- read.csv("../../pernei/new2TSS5000_H9NvsNF_1129over71797_WGBS_perneighbor.csv",header=T,sep=",")
meth.tes <- read.csv("../../pernei/new2TES5000_H9NvsNF_7462over491513_WGBS_perneighbor.csv",header=T,sep=",")
meth <- rbind(meth.tss,meth.tes)
sig.genes <- unique(meth$gene)
out.h9nnf = pathway_analysis_meth(sig.genes, all.genes, class = "mmu")
pathway <- c("NAFLD",
"Fat digestion and absorption",
"Fatty acid elongation",
"Fatty acid degradation",
"Linoleic acid metabolism",
"Biosynthesis of unsaturated fatty acids",
"Oxidative phosphorylation",
"Cholesterol metabolism",
"Steroid hormone biosynthesis",
"Primary bile acid biosynthesis",
"Bile secretion",
"Glycerolipid metabolism",
"Glycerophospholipid metabolism",
"Sphingolipid metabolism",
"Sphingolipid signaling pathway",
"Glycosphingolipid biosynthesis - ganglio series",
"Autophagy - animal")
path.ids <- check_pathway_name(pathway, class="mmu")
list.info = list(out.hfnf[[2]], out.h9nnf[[2]])
group.info = c("HF vs. NF", "H9N vs. NF")
path.names <- c("NAFLD",
"Fat digestion and absorption",
"Fatty acid elongation",
"Fatty acid degradation",
"Linoleic acid metabolism",
"Biosynthesis of unsaturated \nfatty acids",
"Oxidative phosphorylation",
"Cholesterol metabolism",
"Steroid hormone biosynthesis",
"Primary bile acid biosynthesis",
"Bile secretion",
"Glycerolipid metabolism",
"Glycerophospholipid metabolism",
"Sphingolipid metabolism",
"Sphingolipid signaling pathway",
"Glycosphingolipid biosynthesis",
"Autophagy")
fig_path(path.ids, list.info, group.info, criterion = "percentage", path.names = path.names,
width = 2800, height = 2400, out.name = "fig1_meth_percentage.tiff")
fig_path(path.ids, list.info, group.info, criterion = "pval", path.names = path.names,
width = 2800, height = 2400, out.name = "fig1_meth_pval.tiff")
pathway <- c("One carbon pool by folate",
"Glycine, serine and threonine metabolism",
"Folate biosynthesis",
"Cysteine and methionine metabolism",
"Choline metabolism in cancer",
"Central carbon metabolism in cancer",
"Purine metabolism",
"Pyrimidine metabolism")
path.ids <- check_pathway_name(pathway, class = "mmu")
path.names <- c("One carbon pool by folate",
"Glycine, serine and \nthreonine metabolism",
"Folate biosynthesis",
"Cysteine and methionine \nmetabolism",
"Choline metabolism in cancer",
"Central carbon metabolism \nin cancer",
"Purine metabolism",
"Pyrimidine metabolism")
fig_path(path.ids, list.info, group.info, criterion = "percentage", path.names = path.names,
width = 2000, height = 2400, out.name = "fig2_meth_percentage.tiff")
fig_path(path.ids, list.info, group.info, criterion = "pval", path.names = path.names,
width = 2000, height = 2400, out.name = "fig2_meth_pval.tiff")
names(meth)[1] <- "external_gene_name"
extract_degs_by_pathway(pathway, meth, class = "mmu", out.name = "fig2_DMRs.xlsx")
setwd("~/OtherBio/Methylation/regttest2_BY0225/pathway_meth/hui1201")
library(quickpath)
# tss <- readRDS("../tss_pernei.rds")
# tes <- readRDS("../tes_pernei.rds")
# methyl <- rbind(tss,tes)
# all.genes <- unique(methyl$gene)
# saveRDS(all.genes, "all_genes.rds")
all.genes <- readRDS("all_genes.rds")
meth.tss <- read.csv("../../pernei/new2TSS5000_HFvsNF_1646over66988_WGBS_perneighbor.csv",header=T,sep=",")
meth.tes <- read.csv("../../pernei/new2TES5000_HFvsNF_10345over455434_WGBS_perneighbor.csv",header=T,sep=",")
meth <- rbind(meth.tss,meth.tes)
sig.genes <- unique(meth$gene)
out.hfnf = pathway_analysis_meth(sig.genes, all.genes, class = "mmu")
meth.tss <- read.csv("../../pernei/new2TSS5000_H9NvsNF_1129over71797_WGBS_perneighbor.csv",header=T,sep=",")
meth.tes <- read.csv("../../pernei/new2TES5000_H9NvsNF_7462over491513_WGBS_perneighbor.csv",header=T,sep=",")
meth <- rbind(meth.tss,meth.tes)
sig.genes <- unique(meth$gene)
out.h9nnf = pathway_analysis_meth(sig.genes, all.genes, class = "mmu")
pathway <- c("NAFLD",
"Fat digestion and absorption",
"Fatty acid elongation",
"Fatty acid degradation",
"Linoleic acid metabolism",
"Biosynthesis of unsaturated fatty acids",
"Oxidative phosphorylation",
"Cholesterol metabolism",
"Steroid hormone biosynthesis",
"Primary bile acid biosynthesis",
"Bile secretion",
"Glycerolipid metabolism",
"Glycerophospholipid metabolism",
"Sphingolipid metabolism",
"Sphingolipid signaling pathway",
"Glycosphingolipid biosynthesis - ganglio series",
"Autophagy - animal")
path.ids <- check_pathway_name(pathway, class="mmu")
list.info = list(out.hfnf[[2]], out.h9nnf[[2]])
group.info = c("HF vs. NF", "H9N vs. NF")
path.names <- c("NAFLD",
"Fat digestion and absorption",
"Fatty acid elongation",
"Fatty acid degradation",
"Linoleic acid metabolism",
"Biosynthesis of unsaturated \nfatty acids",
"Oxidative phosphorylation",
"Cholesterol metabolism",
"Steroid hormone biosynthesis",
"Primary bile acid biosynthesis",
"Bile secretion",
"Glycerolipid metabolism",
"Glycerophospholipid metabolism",
"Sphingolipid metabolism",
"Sphingolipid signaling pathway",
"Glycosphingolipid biosynthesis",
"Autophagy")
fig_path(path.ids, list.info, group.info, criterion = "percentage", path.names = path.names,
width = 2800, height = 2400, out.name = "fig1_meth_percentage.tiff")
fig_path(path.ids, list.info, group.info, criterion = "pval", path.names = path.names,
width = 2800, height = 2400, out.name = "fig1_meth_pval.tiff")
pathway <- c("One carbon pool by folate",
"Glycine, serine and threonine metabolism",
"Folate biosynthesis",
"Cysteine and methionine metabolism",
"Choline metabolism in cancer",
"Central carbon metabolism in cancer",
"Purine metabolism",
"Pyrimidine metabolism")
path.ids <- check_pathway_name(pathway, class = "mmu")
path.names <- c("One carbon pool by folate",
"Glycine, serine and \nthreonine metabolism",
"Folate biosynthesis",
"Cysteine and methionine \nmetabolism",
"Choline metabolism in cancer",
"Central carbon metabolism \nin cancer",
"Purine metabolism",
"Pyrimidine metabolism")
fig_path(path.ids, list.info, group.info, criterion = "percentage", path.names = path.names,
width = 2000, height = 2400, out.name = "fig2_meth_percentage.tiff")
fig_path(path.ids, list.info, group.info, criterion = "pval", path.names = path.names,
width = 2000, height = 2400, out.name = "fig2_meth_pval.tiff")
names(meth)[1] <- "external_gene_name"
extract_degs_by_pathway(pathway, meth, class = "mmu", out.name = "fig2_DMRs.xlsx")
library(quickpath)
library(quickpath)
library(quickpath)
# tss <- readRDS("../tss_pernei.rds")
# tes <- readRDS("../tes_pernei.rds")
# methyl <- rbind(tss,tes)
# all.genes <- unique(methyl$gene)
# saveRDS(all.genes, "all_genes.rds")
all.genes <- readRDS("all_genes.rds")
meth.tss <- read.csv("../../pernei/new2TSS5000_HFvsNF_1646over66988_WGBS_perneighbor.csv",header=T,sep=",")
meth.tes <- read.csv("../../pernei/new2TES5000_HFvsNF_10345over455434_WGBS_perneighbor.csv",header=T,sep=",")
meth <- rbind(meth.tss,meth.tes)
sig.genes <- unique(meth$gene)
out.hfnf = pathway_analysis_meth(sig.genes, all.genes, class = "mmu")
meth.tss <- read.csv("../../pernei/new2TSS5000_H9NvsNF_1129over71797_WGBS_perneighbor.csv",header=T,sep=",")
meth.tes <- read.csv("../../pernei/new2TES5000_H9NvsNF_7462over491513_WGBS_perneighbor.csv",header=T,sep=",")
meth <- rbind(meth.tss,meth.tes)
sig.genes <- unique(meth$gene)
out.h9nnf = pathway_analysis_meth(sig.genes, all.genes, class = "mmu")
pathway <- c("NAFLD",
"Fat digestion and absorption",
"Fatty acid elongation",
"Fatty acid degradation",
"Linoleic acid metabolism",
"Biosynthesis of unsaturated fatty acids",
"Oxidative phosphorylation",
"Cholesterol metabolism",
"Steroid hormone biosynthesis",
"Primary bile acid biosynthesis",
"Bile secretion",
"Glycerolipid metabolism",
"Glycerophospholipid metabolism",
"Sphingolipid metabolism",
"Sphingolipid signaling pathway",
"Glycosphingolipid biosynthesis - ganglio series",
"Autophagy - animal")
path.ids <- check_pathway_name(pathway, class="mmu")
list.info = list(out.hfnf[[2]], out.h9nnf[[2]])
group.info = c("HF vs. NF", "H9N vs. NF")
path.names <- c("NAFLD",
"Fat digestion and absorption",
"Fatty acid elongation",
"Fatty acid degradation",
"Linoleic acid metabolism",
"Biosynthesis of unsaturated \nfatty acids",
"Oxidative phosphorylation",
"Cholesterol metabolism",
"Steroid hormone biosynthesis",
"Primary bile acid biosynthesis",
"Bile secretion",
"Glycerolipid metabolism",
"Glycerophospholipid metabolism",
"Sphingolipid metabolism",
"Sphingolipid signaling pathway",
"Glycosphingolipid biosynthesis",
"Autophagy")
fig_path(path.ids, list.info, group.info, criterion = "percentage", path.names = path.names,
width = 2800, height = 2400, out.name = "fig1_meth_percentage.tiff")
fig_path(path.ids, list.info, group.info, criterion = "pval", path.names = path.names,
width = 2800, height = 2400, out.name = "fig1_meth_pval.tiff")
pathway <- c("One carbon pool by folate",
"Glycine, serine and threonine metabolism",
"Folate biosynthesis",
"Cysteine and methionine metabolism",
"Choline metabolism in cancer",
"Central carbon metabolism in cancer",
"Purine metabolism",
"Pyrimidine metabolism")
path.ids <- check_pathway_name(pathway, class = "mmu")
path.names <- c("One carbon pool by folate",
"Glycine, serine and \nthreonine metabolism",
"Folate biosynthesis",
"Cysteine and methionine \nmetabolism",
"Choline metabolism in cancer",
"Central carbon metabolism \nin cancer",
"Purine metabolism",
"Pyrimidine metabolism")
fig_path(path.ids, list.info, group.info, criterion = "percentage", path.names = path.names,
width = 2000, height = 2400, out.name = "fig2_meth_percentage.tiff")
fig_path(path.ids, list.info, group.info, criterion = "pval", path.names = path.names,
width = 2000, height = 2400, out.name = "fig2_meth_pval.tiff")
names(meth)[1] <- "external_gene_name"
extract_degs_by_pathway(pathway, meth, class = "mmu", out.name = "fig2_DMRs.xlsx")
library(quickpath)
# tss <- readRDS("../tss_pernei.rds")
# tes <- readRDS("../tes_pernei.rds")
# methyl <- rbind(tss,tes)
# all.genes <- unique(methyl$gene)
# saveRDS(all.genes, "all_genes.rds")
all.genes <- readRDS("all_genes.rds")
meth.tss <- read.csv("../../pernei/new2TSS5000_HFvsNF_1646over66988_WGBS_perneighbor.csv",header=T,sep=",")
meth.tes <- read.csv("../../pernei/new2TES5000_HFvsNF_10345over455434_WGBS_perneighbor.csv",header=T,sep=",")
meth <- rbind(meth.tss,meth.tes)
sig.genes <- unique(meth$gene)
out.hfnf = pathway_analysis_meth(sig.genes, all.genes, class = "mmu")
meth.tss <- read.csv("../../pernei/new2TSS5000_H9NvsNF_1129over71797_WGBS_perneighbor.csv",header=T,sep=",")
meth.tes <- read.csv("../../pernei/new2TES5000_H9NvsNF_7462over491513_WGBS_perneighbor.csv",header=T,sep=",")
meth <- rbind(meth.tss,meth.tes)
sig.genes <- unique(meth$gene)
out.h9nnf = pathway_analysis_meth(sig.genes, all.genes, class = "mmu")
pathway <- c("NAFLD",
"Fat digestion and absorption",
"Fatty acid elongation",
"Fatty acid degradation",
"Linoleic acid metabolism",
"Biosynthesis of unsaturated fatty acids",
"Oxidative phosphorylation",
"Cholesterol metabolism",
"Steroid hormone biosynthesis",
"Primary bile acid biosynthesis",
"Bile secretion",
"Glycerolipid metabolism",
"Glycerophospholipid metabolism",
"Sphingolipid metabolism",
"Sphingolipid signaling pathway",
"Glycosphingolipid biosynthesis - ganglio series",
"Autophagy - animal")
path.ids <- check_pathway_name(pathway, class="mmu")
list.info = list(out.hfnf[[2]], out.h9nnf[[2]])
group.info = c("HF vs. NF", "H9N vs. NF")
path.names <- c("NAFLD",
"Fat digestion and absorption",
"Fatty acid elongation",
"Fatty acid degradation",
"Linoleic acid metabolism",
"Biosynthesis of unsaturated \nfatty acids",
"Oxidative phosphorylation",
"Cholesterol metabolism",
"Steroid hormone biosynthesis",
"Primary bile acid biosynthesis",
"Bile secretion",
"Glycerolipid metabolism",
"Glycerophospholipid metabolism",
"Sphingolipid metabolism",
"Sphingolipid signaling pathway",
"Glycosphingolipid biosynthesis",
"Autophagy")
fig_path(path.ids, list.info, group.info, criterion = "percentage", path.names = path.names,
width = 2800, height = 2400, out.name = "fig1_meth_percentage.tiff")
fig_path(path.ids, list.info, group.info, criterion = "pval", path.names = path.names,
width = 2800, height = 2400, out.name = "fig1_meth_pval.tiff")
extract_degs_by_pathway(pathway, meth, class = "mmu", out.name = "fig1_DMRs.xlsx")
pathway <- c("One carbon pool by folate",
"Glycine, serine and threonine metabolism",
"Folate biosynthesis",
"Cysteine and methionine metabolism",
"Choline metabolism in cancer",
"Central carbon metabolism in cancer",
"Purine metabolism",
"Pyrimidine metabolism")
path.ids <- check_pathway_name(pathway, class = "mmu")
path.names <- c("One carbon pool by folate",
"Glycine, serine and \nthreonine metabolism",
"Folate biosynthesis",
"Cysteine and methionine \nmetabolism",
"Choline metabolism in cancer",
"Central carbon metabolism \nin cancer",
"Purine metabolism",
"Pyrimidine metabolism")
fig_path(path.ids, list.info, group.info, criterion = "percentage", path.names = path.names,
width = 2000, height = 2400, out.name = "fig2_meth_percentage.tiff")
fig_path(path.ids, list.info, group.info, criterion = "pval", path.names = path.names,
width = 2000, height = 2400, out.name = "fig2_meth_pval.tiff")
names(meth)[1] <- "external_gene_name"
extract_degs_by_pathway(pathway, meth, class = "mmu", out.name = "fig2_DMRs.xlsx")
